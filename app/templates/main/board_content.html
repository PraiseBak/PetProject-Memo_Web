{% extends 'main/clone_base.html' %}
{% block content %}

<html>
                
    <body>

        <div class="container my-3">
            
            <header>


                <br>
                {% for field, errors in form.errors.items() %}
                <div class="alert alert-danger" role="alert">
                    <strong>{{ form[field].label }}</strong>: {{ ', '.join(errors) }}
                </div>
                {% endfor %}
                <!-- flash 오류 -->
                {% for message in get_flashed_messages() %}
                <div class="alert alert-danger" role="alert">
                    {{ message }}
                </div>
                {% endfor %}


                <div class= "upside">

                    <h3 class="title">
                        <span class="title_text" style=float:left;> &nbsp Title: {{ content[0]['board_content_title'] }}
                        </span>

                        <style>
                            .title_text
                            {
                                text-transform: none;
                            }
                        </style>
                        
                    </h3>
                

            
                    <div class="btns">
                        <div class="modify">  
                            <a href="#" url="{{ url_for('clone_board.modify',board_content_idx=content[0]['board_content_idx'],password=-1)}}" 
                                class="button" id="modifyBtn" onclick="btn_click(this)">수정</a>
                        </div>
                        <div class="delete">  
                            <a href="#" url="{{ url_for('clone_board.delContent',board_content_idx=content[0]['board_content_idx'],password=-1) }}"
                                class="button" id="deleteBtn" onclick=btn_click(this)> 삭제 </a>
                        </div>
                    </div>
                </div>

                <style>
                    .modify{
                        list-style: none;
                        float: right;
                        margin-right:20px;
                        box-sizing: border-box;
                    }
                    .delete{
                        list-style: none;
                        float: right;
                        margin-right:10px;
                        box-sizing: border-box;
                    }
                    .container{
                        list-style: none;
                    }
                    .upside{
                        border-bottom: 2px solid #bcbcbc; 
                        height: 65px;

                    }
                    
                    .comment_area{
                        text-align:left;
                    }
                </style>
                
            </header>
            <br>
            <br>
            
            <div class="write_div" style="float:left;">
                &nbsp&nbsp&nbsp {{content[0]['board_content']}}
            </div>
            

            <br><br><br><br>
        </div> 
            <hr color= "black">

        <div class="comment_area">
            
            <form method="post" class="post-form">
                <div class="content_area">
                    <input type="username" placeholder="닉네임" class="form-control" name="username" id="username" > <br>
                    <input type="password" maxlength="10" placeholder="비밀번호" size= "10"
                        class="form-control" name="password" id="password" style="width:185px;">
                    <form action="{{ url_for('clone_board.content',board_content_idx=board_content_idx) }}" method="post">
                        
                        <label for="content_text" style="font-size:16px;"></label>
                        <textarea name="content_text" id="content_text" rows="4"></textarea>
                        <input type="submit" style="font-size:16px;" value="등록">
                    </form>
                </div>
            </form>


            <style>
                .content_area{
                    text-align:left;
                }
            </style>
            <table class="table" style="table-layout:fixed;">
                <tr class="thead-dark">
                </tr>   
                <tbody> 
                    {%for comment in comment_data %}
                        <tr>
                            <td style = "cursor:pointer;" onclick=comment_click(this,{{loop.index}}) >
                                {{ comment['username'] }}
                            </td>
                            <td style = "cursor:pointer; word-break:break-all;" onclick=comment_click(this,{{loop.index}}) >
                                {{ comment['comment'] }}
                            </td>
                            
                            <td style = "cursor:pointer;" onclick=comment_click(this,{{loop.index}}) >
                                {{ comment['write_time'] }}
                            </td>
                            
                            <td>
                                <div id="comment_btns">
                                    <div class=button id="del_btn" idx={{loop.index}} onclick=btn_click(this,{{loop.index}})
                                        url="{{ url_for('clone_board.delComment',board_content_idx=content[0]['board_content_idx'],comment_password=-1,comment_idx=-1)}}">
                                        삭제
                                    </div>
                                </div>
                            </td>
                            <style>
                                #comment_btns{
                                    text-align:right;
                                }
                            </style>
                        </tr>

                        <tr>
                            <div class="content_area" id="comment_area">
                                <form method="post" class="post-form">
                                    <td style="border-bottom-style:hidden;  display:none; width:1000px;"  id="comment_userinfo{{comment['comment_idx']}}"> <br>
                                        
                                            <input type="username" placeholder="닉네임" class="form-control" name="username" id="username" > 
                                            <input type="password" maxlength="10" placeholder="비밀번호" size= "10"
                                                class="form-control" name="password" id="password" style="width:175px; height:32px; display:inline-block;">

                                            <form action="{{ url_for('clone_board.subCommentAdd',board_content_idx=board_content_idx,parent_comment_idx=comment['comment_idx'] )}}" method="post">
                                                <label for="content_text" style="font-size:16px;"></label>
                                                <textarea name="content_text" id="content_text" rows="4"  ></textarea>
                                                <input type="submit" style="font-size:16px;" value="등록2">
                                            </form>
                                    </td>

                                </form>
                             </div>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>      
               
            





        </div>
            



    </body>
    <br>
</html>

{% endblock %}


{% block script %}


<script type='text/javascript'>

function btn_click(obj)
{
    var idx = $(obj).attr('idx');
    
    var result = prompt("비밀번호를 입력하세요");
    var url = $(obj).attr('url');
    if(result != "")
    {
        url = url.replace(-1,result);
        if(!(idx === undefined))
        {
            url = url.replace(-1,idx);
        }
        location.href = url;

    }
    else
    {
        alert("비밀번호를 입력해주세요");
    }

}

function comment_click(obj,idx)
{
    var comment_userinfo = document.getElementById("comment_userinfo"+idx);
    var comment_body = document.getElementById("comment_body"+idx);
    if(comment_userinfo.style.display == "block")
    {
        comment_userinfo.style.display = "none";
        comment_body.style.display = "none";
    }
    else
    {
        comment_userinfo.style.display = "block";
        comment_body.style.display = "block";
    }
    
}

</script>

{% endblock %}